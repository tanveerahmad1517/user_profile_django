{% extends "layout.html" %}

{% block title %}Edit Profile | {{ block.super }}{% endblock %}

{% block body %}
    <div class="grid-25">
        nav here
    </div>

    <div class="grid-75">
        <h1>Edit Avatar</h1>
        {% if user.profile.avatar %}
            <div class="circle--primary--avatar">
                <img src="{{ user.profile.avatar.url }}" id="target">
            </div>
        {% endif %}

        {% if user.profile.avatar %}
            <div id="editor-outer">
                <div class="editor-inner">
                <form action="{% url 'accounts:edit_avatar_crop' %}" method="GET">
                    <input type="hidden" size="4" id="x1" name="x1" />
                    <input type="hidden" size="4" id="y1" name="y1" />
                    <input type="hidden" size="4" id="x2" name="x2" />
                    <input type="hidden" size="4" id="y2" name="y2" />

                    <div class="editor-inner"><input type="submit" class="button" value="Crop"></div>
                </form>
                </div>
                <div class="editor-inner">
                <form action="{% url 'accounts:edit_avatar_rotate' %}" method="GET">
                    <button class="button">Rotate</button>
                </form>
                </div>
                <div class="editor-inner">
                <form action="{% url 'accounts:edit_avatar_flip' %}" method="GET">
                    <div class="editor-inner"><button class="button">Flip</button></div>
                </form>
                </div>
            </div>
        {% endif %}

        <form enctype="multipart/form-data" method="POST" action="">
            {% csrf_token %}
            <br>
            New file: <input id="id_avatar" name="avatar" type="file">

            {% if user.profile.avatar %}
                <input id="avatar-clear_id" name="avatar-clear" type="checkbox"> Clear
            {% endif %}
            <br>
            <input type="submit" class="button-primary" value="Change">
        </form>

    </div>


    <!--<div class="grid-75">-->
        <!--<h1>Edit Avatar</h1>-->
        <!--{% if user.profile.avatar %}-->
            <!--<div class="circle&#45;&#45;primary&#45;&#45;avatar">-->
                <!--<img src="{{ user.profile.avatar.url }}" id="target">-->
            <!--</div>-->
        <!--{% endif %}-->
        <!--<form enctype="multipart/form-data" method="POST" action="">-->
            <!--{% csrf_token %}-->
            <!--{{ form.as_p }}-->
            <!--<input type="submit" class="button-primary" value="Save file">-->
        <!--</form>-->
    <!--</div>-->
{% endblock %}

{% block css %}
    {% load static from staticfiles %}
    <link rel="stylesheet" href="{% static 'css/jquery.Jcrop.css' %}" type="text/css" />
{% endblock %}

{% block javascript %}
    {% load static from staticfiles %}
    <!--<script src="js/jquery.min.js"></script>-->
    <script src="{% static 'js/jquery.Jcrop.min.js' %}"></script>
    <script language="Javascript">
        function showCoords(c)
        {
            $('#x1').val(c.x);
            $('#y1').val(c.y);
            $('#x2').val(c.x2);
            $('#y2').val(c.y2);
        };
    </script>
    <script language="Javascript">
    jQuery(function($) {
        $('#target').Jcrop({
            onSelect: showCoords,
            onChange: showCoords
        });
    });
    </script>
{% endblock %}